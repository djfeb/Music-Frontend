(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6636],{2355:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},3786:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])},3803:(e,t,s)=>{Promise.resolve().then(s.bind(s,4485))},4186:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},4485:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>E});var a=s(5155),l=s(2115),i=s(5695),n=s(6766),r=s(1007),c=s(9946);let o=(0,c.A)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),d=(0,c.A)("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);var h=s(2355);let m=(0,c.A)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var x=s(4186),u=s(227),p=s(5690),f=s(1976),g=s(7168),j=s(5970),v=s(5824),b=s(2324),y=s(5683),N=s(9338),w=s(875),k=s(4503),z=s(5317),A=s(8915),C=s(330),P=s(6950);function E(){var e,t,s,c;let{user:E,isLoading:S,historyTrackIds:M,favoriteTrackIds:L,refreshHistory:_,deleteAccount:T,contentPreferences:U,updateContentPreferences:$}=(0,y.A)(),F=(0,N.F)(),q=(0,i.useRouter)(),{toast:D}=(0,k.dj)(),[H,R]=(0,l.useState)([]),[Y,I]=(0,l.useState)(!1),[O,V]=(0,l.useState)(!1),[G,B]=(0,l.useState)(!1),[J,K]=(0,l.useState)(!1),Q=(null==E?void 0:null===(e=E.photoURL)||void 0===e?void 0:e.includes("googleusercontent.com"))||!1;(0,l.useEffect)(()=>{S||E||q.push("/sign-in")},[E,S,q]),(0,l.useEffect)(()=>{(async()=>{if(!M.length){R([]);return}I(!0);try{let e=M.filter((e,t,s)=>s.indexOf(e)===t).slice(0,20),t=await Promise.all(e.map(async e=>{try{var t,s,a,l;let i=await w.i.getTrack(e),n="Unknown Album",r=null===(s=i.album_images)||void 0===s?void 0:null===(t=s[0])||void 0===t?void 0:t.url,c=null;try{n=(c=await w.i.getAlbum(i.album_id)).name,!r&&(null===(l=c.images)||void 0===l?void 0:l.length)>0&&(r=(c.images.find(e=>e.width>=200&&e.width<=400)||c.images[0]).url)}catch(t){console.warn("Could not fetch album for track ".concat(e))}let o={...i,album_images:(null==c?void 0:c.images)||i.album_images||[]};return{id:e,name:i.name,artist:(null===(a=i.artists)||void 0===a?void 0:a[0])||"Unknown Artist",album:n,image:r,duration:i.duration_ms?"".concat(Math.floor(i.duration_ms/6e4),":").concat(String(Math.floor(i.duration_ms%6e4/1e3)).padStart(2,"0")):"0:00",track:o}}catch(t){return console.warn("Could not fetch track ".concat(e,":"),t),{id:e,name:"Unknown Track",artist:"Unknown Artist",album:"Unknown Album",duration:"0:00"}}}));R(t)}catch(e){console.error("Error fetching history tracks:",e),R([])}finally{I(!1)}})()},[M]);let W=async()=>{if(E){V(!0);try{let e=(0,z.rJ)(A.db,"users",E.uid,"history"),t=await (0,z.GG)(e),s=(0,z.wP)(A.db);t.docs.forEach(e=>{s.delete(e.ref)}),await s.commit(),await _(),R([]),D({title:"History cleared",description:"Your listening history has been successfully deleted."})}catch(e){console.error("Error clearing history:",e),D({title:"Error",description:"Failed to clear listening history. Please try again.",variant:"destructive"})}finally{V(!1)}}},X=async()=>{if(E&&window.confirm("Are you sure you want to delete your account? This action cannot be undone and will permanently delete:\n\n• Your profile and preferences\n• All playlists\n• Listening history\n• Favorite tracks\n• Followed artists\n• All personalization data\n\nType 'DELETE' to confirm:")){if("DELETE"!==window.prompt("Type 'DELETE' to confirm account deletion:")){D({title:"Account Deletion Cancelled",description:"Account deletion was cancelled."});return}B(!0);try{await T(),D({title:"Account Deleted",description:"Your account and all data have been permanently deleted."}),q.push("/")}catch(t){console.error("Error deleting account:",t);let e="Failed to delete account. Please try again.";(null==t?void 0:t.code)==="auth/requires-recent-login"&&(e="For security reasons, please sign out and sign back in, then try deleting your account again."),D({title:"Error",description:e,variant:"destructive"})}finally{B(!1)}}},Z=()=>{K(!0)},ee=async e=>{try{await $({...e,hasSetPreferences:!0}),K(!1),D({title:"Preferences Updated",description:"Your music preferences have been updated successfully."})}catch(e){console.error("Error updating preferences:",e),D({title:"Error",description:"Failed to update preferences. Please try again.",variant:"destructive"})}};return S||!E?(0,a.jsx)("div",{className:"flex h-[calc(100vh-5rem)] items-center justify-center bg-black text-white",children:(0,a.jsx)("p",{children:"Loading..."})}):(0,a.jsxs)("div",{className:"flex h-[calc(100vh-5rem)] bg-black text-white overflow-hidden",children:[J&&(0,a.jsx)(b.H,{onPreferencesSet:ee,onSkip:()=>{K(!1)},existingPreferences:U}),(0,a.jsx)(j.B,{}),(0,a.jsx)("main",{className:"flex-1 overflow-auto",children:(0,a.jsx)("div",{className:"bg-gradient-to-b from-purple-900 to-black",children:(0,a.jsxs)("div",{className:"p-6 md:p-8 relative",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row items-center md:items-end gap-6 pt-16 md:pt-0",children:[E.photoURL?(0,a.jsx)(n.default,{src:E.photoURL,alt:E.displayName||"User",width:192,height:192,className:"rounded-full"}):(0,a.jsx)("div",{className:"h-48 w-48 rounded-full bg-zinc-800 flex items-center justify-center",children:(0,a.jsx)(r.A,{className:"h-24 w-24 text-zinc-500"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs uppercase font-medium",children:"Profile"}),(0,a.jsx)("h1",{className:"text-3xl md:text-5xl font-bold mt-2 mb-4",children:E.displayName}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-zinc-400",children:[(0,a.jsx)(o,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:E.email})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-zinc-400",children:[(0,a.jsx)(d,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:[H.length," unique tracks played"]})]})]})]})]}),(0,a.jsx)(g.$,{variant:"ghost",size:"icon",className:"hidden sm:flex mt-10 left-6 rounded-full h-10 w-10 bg-black/20 hover:bg-black/40 backdrop-blur-sm text-white border border-white/20 z-10",onClick:()=>window.history.back(),children:(0,a.jsx)(h.A,{className:"h-6 w-6"})}),(0,a.jsxs)("div",{className:"mt-8 space-y-6",children:[(0,a.jsxs)("section",{children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold mb-4 flex items-center gap-2",children:[(0,a.jsx)(m,{className:"h-5 w-5 text-green-500"}),"Music Preferences"]}),(0,a.jsx)("div",{className:"bg-zinc-900/50 rounded-xl p-6",children:(null==U?void 0:U.hasSetPreferences)&&U.preferredContinents?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-lg mb-2",children:"Preference Type"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:["international"===U.preferenceType&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),(0,a.jsx)("span",{children:"International Music"})]}),"local"===U.preferenceType&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-orange-500 rounded-full"}),(0,a.jsx)("span",{children:"Local & African Music"})]}),"mixed"===U.preferenceType&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),(0,a.jsx)("span",{children:"Mixed (International & Local)"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-lg mb-2",children:"Preferred Regions"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[null===(t=U.preferredContinents)||void 0===t?void 0:t.slice(0,8).map(e=>(0,a.jsx)("span",{className:"px-3 py-1 bg-zinc-800 rounded-full text-sm text-zinc-300",children:e},e)),((null===(s=U.preferredContinents)||void 0===s?void 0:s.length)||0)>8&&(0,a.jsxs)("span",{className:"px-3 py-1 bg-zinc-700 rounded-full text-sm text-zinc-400",children:["+",((null===(c=U.preferredContinents)||void 0===c?void 0:c.length)||0)-8," more"]})]})]})]}):(null==U?void 0:U.hasSetPreferences)?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(m,{className:"h-12 w-12 text-zinc-600 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"font-semibold text-lg mb-2",children:"Preferences Need Update"}),(0,a.jsx)("p",{className:"text-zinc-400 mb-4",children:"Your preferences need to be updated to the new continent-based system"}),(0,a.jsx)(g.$,{onClick:Z,className:"bg-blue-500 hover:bg-blue-600 text-white",children:"Update Preferences"})]}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(m,{className:"h-12 w-12 text-zinc-600 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"font-semibold text-lg mb-2",children:"No Preferences Set"}),(0,a.jsx)("p",{className:"text-zinc-400 mb-4",children:"Set your music preferences to get personalized recommendations"}),(0,a.jsx)(g.$,{onClick:Z,className:"bg-green-500 hover:bg-green-600 text-black",children:"Set Preferences"})]})})]}),(0,a.jsxs)("section",{children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold mb-4 flex items-center gap-2",children:[(0,a.jsx)(d,{className:"h-5 w-5 text-blue-500"}),"Recently Played"]}),Y?(0,a.jsx)("div",{className:"bg-zinc-900/50 rounded-xl p-8 text-center",children:(0,a.jsx)("p",{className:"text-zinc-400",children:"Loading your listening history..."})}):H.length>0?(0,a.jsx)("div",{className:"bg-zinc-900/50 rounded-xl p-4 max-h-[600px] overflow-y-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"sticky top-0 bg-zinc-900/90 backdrop-blur-sm",children:(0,a.jsxs)("tr",{className:"text-zinc-400 text-left border-b border-zinc-800 text-sm",children:[(0,a.jsx)("th",{className:"pb-3 pl-4",children:"#"}),(0,a.jsx)("th",{className:"pb-3",children:"Title"}),(0,a.jsx)("th",{className:"pb-3 hidden md:table-cell",children:"Album"}),(0,a.jsx)("th",{className:"pb-3 text-right pr-4",children:(0,a.jsx)(x.A,{className:"h-4 w-4 inline"})})]})}),(0,a.jsx)("tbody",{children:H.map((e,t)=>{var s,l;let i=(null===(s=F.current)||void 0===s?void 0:s.id)===e.id,r=e.track;return(0,a.jsxs)("tr",{className:"group hover:bg-zinc-800/50 text-sm cursor-pointer",onClick:()=>{if(r){let t=H.filter(e=>e.track).map(e=>e.track);F.play(e.track,{queue:t,autoplay:!0})}},children:[(0,a.jsx)("td",{className:"py-3 pl-4",children:(0,a.jsx)("span",{className:"".concat(i?"text-green-500":"text-zinc-400"),children:t+1})}),(0,a.jsx)("td",{className:"py-3",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"relative w-10 h-10 bg-zinc-700 rounded flex items-center justify-center overflow-hidden group/image",children:[e.image?(0,a.jsx)(n.default,{src:e.image,alt:e.name,width:40,height:40,className:"object-cover w-full h-full",unoptimized:!0}):(0,a.jsx)(u.A,{className:"h-5 w-5 text-zinc-400"}),r&&(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover/image:opacity-100 transition-opacity flex items-center justify-center",children:(0,a.jsx)(g.$,{size:"icon",variant:"secondary",className:"h-6 w-6 rounded-full",onClick:t=>{t.stopPropagation();let s=H.filter(e=>e.track).map(e=>e.track);F.play(e.track,{queue:s,autoplay:!0})},children:(0,a.jsx)(p.A,{className:"h-3 w-3 text-black"})})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium ".concat(i?"text-green-500":"text-white"),children:e.name}),(0,a.jsx)(C.d,{artists:[e.artist],artistIds:null===(l=e.track)||void 0===l?void 0:l.artist_ids,maxLength:20,className:"text-zinc-400 text-xs",showLinks:!0,onClick:e=>{e.stopPropagation()}})]})]})}),(0,a.jsx)("td",{className:"py-3 hidden md:table-cell text-zinc-400",children:e.album}),(0,a.jsx)("td",{className:"py-3 text-right pr-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-end gap-3",children:[r&&(0,a.jsx)(g.$,{variant:"ghost",size:"icon",className:"h-8 w-8 text-zinc-400 opacity-0 group-hover:opacity-100 hover:text-white",onClick:t=>{t.stopPropagation();let s=H.filter(e=>e.track).map(e=>e.track);F.play(e.track,{queue:s,autoplay:!0})},children:(0,a.jsx)(p.A,{className:"h-4 w-4"})}),(0,a.jsx)("span",{className:"text-zinc-400",children:e.duration})]})})]},"".concat(e.id,"-").concat(t))})})]})}):(0,a.jsxs)("div",{className:"bg-zinc-900/50 rounded-xl p-8 text-center",children:[(0,a.jsx)(d,{className:"h-12 w-12 text-zinc-700 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-xl font-medium mb-2",children:"No listening history yet"}),(0,a.jsx)("p",{className:"text-zinc-400 mb-4",children:"Start listening to music to see your recently played tracks here"}),(0,a.jsx)(g.$,{onClick:()=>q.push("/"),children:"Discover Music"})]})]}),(0,a.jsxs)("section",{className:"mt-8",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Support MusicStream"}),(0,a.jsx)("div",{className:"bg-zinc-900/50 rounded-xl p-6 space-y-4",children:(0,a.jsxs)("div",{className:"text-center space-y-4",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-gradient-to-r from-pink-500 to-red-500 rounded-full flex items-center justify-center mx-auto",children:(0,a.jsx)(f.A,{className:"h-8 w-8 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white mb-2",children:"Help Keep MusicStream Free"}),(0,a.jsx)("p",{className:"text-zinc-400 text-sm mb-4",children:"Your support helps us maintain and improve the service for everyone. Consider making a donation to keep MusicStream ad-free and free for all users."})]}),(0,a.jsx)(P.v,{className:"w-full"})]})})]}),(0,a.jsxs)("section",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Account Settings"}),(0,a.jsxs)("div",{className:"bg-zinc-900/50 rounded-xl p-6 space-y-4",children:[!Q&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.$,{variant:"outline",className:"w-full justify-start",onClick:()=>{D({title:"Edit Profile",description:"Profile editing feature coming soon!"})},children:"Edit Profile"}),(0,a.jsx)(g.$,{variant:"outline",className:"w-full justify-start",onClick:()=>{D({title:"Change Password",description:"Password change feature coming soon!"})},children:"Change Password"}),(0,a.jsx)(g.$,{variant:"outline",className:"w-full justify-start",onClick:()=>{D({title:"Notification Settings",description:"Notification settings coming soon!"})},children:"Notification Settings"})]}),(0,a.jsxs)(g.$,{variant:"outline",className:"w-full justify-start text-blue-500 hover:text-blue-400 hover:bg-blue-950/20",onClick:Z,children:[(0,a.jsx)(m,{className:"h-4 w-4 mr-2"}),"Music Preferences"]}),M.length>0&&(0,a.jsx)(g.$,{variant:"outline",className:"w-full justify-start text-orange-500 hover:text-orange-400 hover:bg-orange-950/20",onClick:W,disabled:O,children:O?"Clearing...":"Clear Listening History"}),(0,a.jsx)(g.$,{variant:"outline",className:"w-full justify-start text-red-500 hover:text-red-400 hover:bg-red-950/20",onClick:X,disabled:G,children:G?"Deleting Account...":"Delete Account"})]})]})]})]})})}),(0,a.jsx)(v.MusicPlayer,{})]})}},5196:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},6950:(e,t,s)=>{"use strict";s.d(t,{v:()=>r});var a=s(5155),l=s(1976),i=s(3786),n=s(7168);function r(e){let{variant:t="default",size:s="default",className:r="",showIcon:c=!0,showText:o=!0}=e;return(0,a.jsxs)(n.$,{variant:t,size:s,className:"bg-gradient-to-r from-pink-500 to-red-500 hover:from-pink-600 hover:to-red-600 text-white border-0 ".concat(r),onClick:()=>{window.open("https://www.paypal.com/paypalme/neonflix","_blank","noopener,noreferrer")},children:[c&&(0,a.jsx)(l.A,{className:"h-4 w-4 mr-2"}),o&&"Support Us",(0,a.jsx)(i.A,{className:"h-3 w-3 ml-1"})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[9135,3965,3374,2390,1835,1541,1623,1045,1322,5970,5143,5824,2324,8441,1684,7358],()=>t(3803)),_N_E=e.O()}]);